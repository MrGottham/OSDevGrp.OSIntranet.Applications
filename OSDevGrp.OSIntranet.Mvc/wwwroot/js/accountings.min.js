!function(n){n.fn.extend({getDefaultAccountingNumber:function(){var t=n("#accountingOptionsAccountingNumber").val();return 0===t.length?null:parseInt(t)},getActiveAccountingNumber:function(){var t=n("#loadedAccountingCollection").children("[data-accounting-number]");if(0===t.length)return null;var e=null;return n.each(t,function(){n(this).hasClass("active")&&null===e&&(e=parseInt(n(this).data("accounting-number")))}),e},getActiveOrDefaultAccountingNumber:function(){var t=n().getActiveAccountingNumber();return null!=t?t:n().getDefaultAccountingNumber()},getActiveAccountingUrl:function(){var t=n("#loadedAccountingCollection").children("[data-url]");if(0===t.length)return null;var e=null;return n.each(t,function(){n(this).hasClass("active")&&null===e&&(e=n(this).data("url"))}),e},newAccounting:function(t){var e=n().getPresentAccountingElement();null!==e&&(n(e).data("url",encodeURI(t)),n.each(n(e).parent(),function(){n().startPresentingAccountingObserver(this)}),n().replaceWithPartialViewFromUrl(e))},getAccounting:function(t){var e=n().getPresentAccountingElement();null!==e&&(n(e).data("url",encodeURI(t)),n.each(n(e).parent(),function(){n().startPresentingAccountingObserver(this)}),n().replaceWithPartialViewFromUrl(e))},editAccounting:function(){n().isDisplayed("#editAccounting")||(n().toggleDisplay("#presentAccounting"),n().toggleDisplay("#editAccounting"))},refreshAccountings:function(t){if(0!==n("#loadedAccountingCollection").length){var e=n().getActiveOrDefaultAccountingNumber(),c=decodeURI(t);c=null==e?c.substr(0,c.indexOf("?")):c.replace("{accountingNumber}",e),n().startLoadingAccountings(encodeURI(c))}},startLoadingAccountings:function(t){n.each(n("#accountingCollection"),function(){n().startAccountingCollectionObserver(this),n.each(n(this).children("#loadedAccountingCollection"),function(){n(this).data("url",t),n().replaceWithPartialViewFromUrl(this)})})},startAccountingCollectionObserver:function(t){new MutationObserver(n().accountingCollectionCallback).observe(t,{childList:!0})},accountingCollectionCallback:function(t,e){if(0!==t.length){var c=n(t[0].target).find("#loadedAccountingCollection");if(0!==c.length){e.disconnect();var i=n("#rightContent").is(":hidden");if(n.each(c,function(){n.each(n(this).find("a"),function(){!0===i&&n(this).hasClass("active")&&n(this).removeClass("active"),n(this).on("click",function(t){t.preventDefault(),n(this).tab("show")}),n(this).on("shown.bs.tab",function(t){n().getAccounting(n(t.target).data("url"))})})}),!0!==i){var o=n().getActiveAccountingUrl();null!=o&&n().getAccounting(o)}}else n().handleUrlInstantLoading(n(document))}},getPresentAccountingElement:function(){var t=n("#rightContent");t.is(":hidden")&&(t=n("#leftContent"));var e=null,c=0;return n.each(n(t).children("div"),function(){0===c?(e=n(this),c++):n(this).remove()}),e},startPresentingAccountingObserver:function(t){new MutationObserver(n().presentingAccountingCallback).observe(t,{childList:!0})},presentingAccountingCallback:function(t,e){if(0!==t.length){var c=n(t[0].target).find("[data-url]");if(0===c.length)return e.disconnect(),void n().enableFormValidation("#editAccountingForm");n.each(c,function(){n().replaceWithPartialViewFromUrl(this)})}}}),n(document).ready(function(){n().startAccountingCollectionObserver(document.getElementById("accountingCollection"))})}(jQuery);