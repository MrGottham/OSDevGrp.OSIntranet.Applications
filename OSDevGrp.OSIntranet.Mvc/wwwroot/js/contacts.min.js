!function(t){t.fn.extend({getFilter:function(){return t("#contactOperationsFilter").val()},getCountryCode:function(){return t("#contactOperationsCountryCode").val()},newContact:function(e){var n=t().getPresentContactElement();null!==n&&(e=decodeURI(e).replace("{countryCode}",t().getCountryCode()),t(n).data("url",encodeURI(e)),t.each(t(n).parent(),function(){t().startPresentingContactObserver(this)}),t().replaceWithPartialViewFromUrl(n))},getContact:function(e){var n=t().getPresentContactElement();null!==n&&(e=decodeURI(e).replace("{countryCode}",t().getCountryCode()),t(n).data("url",encodeURI(e)),t.each(t(n).parent(),function(){t().startPresentingContactObserver(this)}),t().replaceWithPartialViewFromUrl(n))},editContact:function(){t().isDisplayed("#editContact")||(t().toggleDisplay("#presentContact"),t().toggleDisplay("#editContact"))},refreshContacts:function(e){0!==t("#loadedContactCollection").length&&(t.each(t("#contactOperationsFilter"),function(){t(this).val("")}),t().startLoadingContacts(e))},searchContacts:function(e,n){var a=decodeURI(n);a=null==e||0===e.length?a.substr(0,a.indexOf("?")):a.replace("{filter}",e),t().startLoadingContacts(encodeURI(a))},startLoadingContacts:function(e){t().setReadOnly("#contactOperationsFilter",!0),t().setDisabled("#contactOperationsSearch",!0),t.each(t("#contactCollection"),function(){t().startContactCollectionObserver(this),t.each(t(this).children("#loadedContactCollection"),function(){t(this).data("url",e),t().replaceWithPartialViewFromUrl(this)})})},startContactCollectionObserver:function(e){new MutationObserver(t().contactCollectionCallback).observe(e,{childList:!0})},contactCollectionCallback:function(e,n){if(0!==e.length){var a=t(e[0].target).find("#loadedContactCollection");0!==a.length?(n.disconnect(),t().setReadOnly("#contactOperationsFilter",!1),t().setDisabled("#contactOperationsSearch",!1),t.each(a,function(){t.each(t(this).find("a"),function(){t(this).on("click",function(e){e.preventDefault(),t(this).tab("show")}),t(this).on("shown.bs.tab",function(e){t().getContact(t(e.target).data("url"))})})})):t().handleUrlInstantLoading(t(document))}},getPresentContactElement:function(){var e=t("#rightContent");e.is(":hidden")&&(e=t("#leftContent"));var n=null,a=0;return t.each(t(e).children("div"),function(){0===a?(n=t(this),a++):t(this).remove()}),n},startPresentingContactObserver:function(e){new MutationObserver(t().presentingContactCallback).observe(e,{childList:!0})},presentingContactCallback:function(e,n){if(0!==e.length){var a=t(e[0].target).find("[data-url]");if(0===a.length)return n.disconnect(),t().isPerson()?t().toggleDisplay("#editContactPersonName"):t().isCompany()&&t().toggleDisplay("#editContactCompanyName"),void t().enableFormValidation("#editContactForm");t.each(a,function(){t().replaceWithPartialViewFromUrl(this)})}},isPerson:function(){return"Person"===t().getRadioValue("#ContactType")},applyPersonContent:function(){if(!t().isDisplayed("#editContactPersonName")){if(t().isDisplayed("#editContactCompanyName")){var e=t("#CompanyName").val();null!=e&&e.length>0&&t("#Surname").val(e),t("#CompanyName").val(""),t().toggleDisplay("#editContactCompanyName")}t().toggleDisplay("#editContactPersonName")}},isCompany:function(){return"Company"===t().getRadioValue("#ContactType")},applyCompanyContent:function(){if(!t().isDisplayed("#editContactCompanyName")){if(t().isDisplayed("#editContactPersonName")){var e="",n=t("#GivenName").val();null!=n&&n.length>0&&(e=n),t("#GivenName").val("");var a=t("#MiddleName").val();null!=a&&a.length>0&&(e=e.length>0?e+" "+a:a),t("#MiddleName").val("");var o=t("#Surname").val();null!=o&&o.length>0&&(e=e.length>0?e+" "+o:o),t("#Surname").val(""),t("#CompanyName").val(e),t().toggleDisplay("#editContactPersonName")}t().toggleDisplay("#editContactCompanyName")}}}),t(document).ready(function(){t().startContactCollectionObserver(document.getElementById("contactCollection"))})}(jQuery);