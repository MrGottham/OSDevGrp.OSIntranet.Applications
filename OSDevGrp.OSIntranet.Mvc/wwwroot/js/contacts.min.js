!function(t){var e=void 0;t.fn.extend({getUrlForExternalIdentifierToPresent:function(){var e=t("#contactOperations").find("#ExternalIdentifier").parent().data("url");return null==e||0===e.length?null:e},getFilter:function(){return t("#contactOperationsFilter").val()},getCountryCode:function(){return t("#contactOperationsCountryCode").val()},newContact:function(e){var a=t().getPresentContactElement();null!==a&&(e=decodeURI(e).replace("{countryCode}",t().getCountryCode()),t(a).data("url",encodeURI(e)),t.each(t(a).parent(),function(){t().startPresentingContactObserver(this)}),t().replaceWithPartialViewFromUrl(a))},getContact:function(e){var a=t().getPresentContactElement();null!==a&&(e=decodeURI(e).replace("{countryCode}",t().getCountryCode()),t(a).data("url",encodeURI(e)),t.each(t(a).parent(),function(){t().startPresentingContactObserver(this)}),t().replaceWithPartialViewFromUrl(a))},editContact:function(){t().isDisplayed("#editContact")||(t().toggleDisplay("#presentContact"),t().toggleDisplay("#editContact"))},cancelEditContact:function(){0!==t("#editContact").length?!1!==t().isDisplayed("#editContact")&&(t().toggleDisplay("#editContact"),t().toggleDisplay("#presentContact")):t("#editContactForm").remove()},refreshContacts:function(e){0!==t("#loadedContactCollection").length&&(t.each(t("#contactOperationsFilter"),function(){t(this).val("")}),t().startLoadingContacts(e))},searchContacts:function(e,a){var n=decodeURI(a);n=null==e||0===e.length?n.substr(0,n.indexOf("?")):n.replace("{filter}",e),t().startLoadingContacts(encodeURI(n))},addAssociatedCompany:function(e){var a=t("#addAssociatedCompany").children("div").first();null!=a&&(e=decodeURI(e).replace("{countryCode}",t().getCountryCode()),a.data("url",encodeURI(e)),t.each(t(a).parent(),function(){t().startAddingAssociatedCompanyObserver(this)}),t().replaceWithPartialViewFromUrl(a))},removeAssociatedCompany:function(){t.each(t("#associatedCompany"),function(){t(this).remove()})},startLoadingContacts:function(e){t().setReadOnly("#contactOperationsFilter",!0),t().setDisabled("#contactOperationsSearch",!0),t.each(t("#contactCollection"),function(){t().startContactCollectionObserver(this),t.each(t(this).children("#loadedContactCollection"),function(){t(this).data("url",e),t().replaceWithPartialViewFromUrl(this)})})},startContactCollectionObserver:function(e){new MutationObserver(t().contactCollectionCallback).observe(e,{childList:!0})},contactCollectionCallback:function(e,a){if(0!==e.length){var n=t(e[0].target).find("#loadedContactCollection");if(0!==n.length){a.disconnect(),t().setReadOnly("#contactOperationsFilter",!1),t().setDisabled("#contactOperationsSearch",!1);var o=t().isRightContentHidden();t.each(n,function(){t.each(t(this).find("a"),function(){!0===o&&t(this).hasClass("active")&&t(this).removeClass("active"),t(this).on("click",function(e){e.preventDefault(),t(this).tab("show")}),t(this).on("shown.bs.tab",function(e){t().getContact(t(e.target).data("url"))})})})}else t().handleUrlInstantLoading(t(document))}},isRightContentHidden:function(){return t("#rightContent").is(":hidden")},getPresentContactElement:function(){var e=t("#rightContent");e.is(":hidden")&&(e=t("#leftContent"));var a=null,n=0;return t.each(t(e).children("div"),function(){0===n?(a=t(this),n++):t(this).remove()}),a},startPresentingContactObserver:function(e){new MutationObserver(t().presentingContactCallback).observe(e,{childList:!0})},presentingContactCallback:function(e,a){if(0!==e.length){var n=t(e[0].target).find("[data-url]");if(0===n.length)return a.disconnect(),t().isPerson()?(t().toggleDisplay("#editContactPersonName"),t().toggleDisplay("#editContactPersonPhoneNumbers"),t().toggleDisplay("#editContactBirthday"),t().hasAssociatedCompany()?t().toggleDisplay("#editAssociatedCompany"):t().toggleDisplay("#addAssociatedCompany")):t().isCompany()&&(t().toggleDisplay("#editContactCompanyName"),t().toggleDisplay("#editContactCompanyPhoneNumbers"),t().hasAssociatedCompany()&&t().toggleDisplay("#editAssociatedCompany")),t(".input-group.date").datepicker({format:"d. MM yyyy",clearBtn:!0,language:"da"}),void t().enableFormValidation("#editContactForm");t.each(n,function(){t().replaceWithPartialViewFromUrl(this)})}},startAddingAssociatedCompanyObserver:function(e){new MutationObserver(t().addingAssociatedCompanyCallback).observe(e,{childList:!0})},addingAssociatedCompanyCallback:function(e,a){if(0!==e.length){var n=t(e[0].target).find("[data-url]");if(0===n.length)return a.disconnect(),void t().enableFormValidation("#editContactForm");t.each(n,function(){t().replaceWithPartialViewFromUrl(this)})}},isPerson:function(){return"Person"===t().getRadioValue("#ContactType")},applyPersonContent:function(){if(!t().isDisplayed("#editContactPersonName")){if(t().isDisplayed("#editContactCompanyName")){var e=t("#CompanyName").val();null!=e&&e.length>0&&t("#Surname").val(e),t("#CompanyName").val(""),t().toggleDisplay("#editContactCompanyName")}t().isDisplayed("#editContactCompanyPhoneNumbers")&&t().toggleDisplay("#editContactCompanyPhoneNumbers"),t().toggleDisplay("#editContactPersonName"),!1===t().isDisplayed("#editContactPersonPhoneNumbers")&&t().toggleDisplay("#editContactPersonPhoneNumbers"),!1===t().isDisplayed("#editContactBirthday")&&t().toggleDisplay("#editContactBirthday"),t().hasAssociatedCompany()?(t().isDisplayed("#addAssociatedCompany")&&t().toggleDisplay("#addAssociatedCompany"),!1===t().isDisplayed("#editAssociatedCompany")&&t().toggleDisplay("#editAssociatedCompany")):(!1===t().isDisplayed("#addAssociatedCompany")&&t().toggleDisplay("#addAssociatedCompany"),t().isDisplayed("#editAssociatedCompany")&&t().toggleDisplay("#editAssociatedCompany"))}},isCompany:function(){return"Company"===t().getRadioValue("#ContactType")},applyCompanyContent:function(){if(!t().isDisplayed("#editContactCompanyName")){if(t().isDisplayed("#editContactPersonName")){var e="",a=t("#GivenName").val();null!=a&&a.length>0&&(e=a),t("#GivenName").val("");var n=t("#MiddleName").val();null!=n&&n.length>0&&(e=e.length>0?e+" "+n:n),t("#MiddleName").val("");var o=t("#Surname").val();null!=o&&o.length>0&&(e=e.length>0?e+" "+o:o),t("#Surname").val(""),t("#CompanyName").val(e),t().toggleDisplay("#editContactPersonName")}t().isDisplayed("#editContactPersonPhoneNumbers")&&t().toggleDisplay("#editContactPersonPhoneNumbers"),t().isDisplayed("#editContactBirthday")&&t().toggleDisplay("#editContactBirthday"),t().toggleDisplay("#editContactCompanyName"),!1===t().isDisplayed("#editContactCompanyPhoneNumbers")&&t().toggleDisplay("#editContactCompanyPhoneNumbers"),t().hasAssociatedCompany()?(t().isDisplayed("#addAssociatedCompany")&&t().toggleDisplay("#addAssociatedCompany"),!1===t().isDisplayed("#editAssociatedCompany")&&t().toggleDisplay("#editAssociatedCompany")):(t().isDisplayed("#addAssociatedCompany")&&t().toggleDisplay("#addAssociatedCompany"),t().isDisplayed("#editAssociatedCompany")&&t().toggleDisplay("#editAssociatedCompany"))}},hasAssociatedCompany:function(){return t("#associatedCompany").length>0},onPostalCodeChange:function(a,n,o,i,s){void 0!==e&&clearTimeout(e),e=setTimeout(function(){var e=t().getCountryCode();if(null!=e&&0!==e.length){var l=t(a).val();null!=l&&0!==l.length&&(s=encodeURI(decodeURI(s).replace("{countryCode}",e).replace("{postalCode}",l)),t.get(s,null,null,"json").done(function(e){t(n).val(e.city),t(o).val(e.state),e.country.defaultForPrincipal?t(i).val(""):t(i).val(e.country.universalName)}))}},500)}}),t(document).ready(function(){t().startContactCollectionObserver(document.getElementById("contactCollection"));var e=t().getUrlForExternalIdentifierToPresent();null!==e&&(t().isRightContentHidden()||t().getContact(e))})}(jQuery);